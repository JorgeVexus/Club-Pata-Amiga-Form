<!-- Swiper CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
<!-- Outfit Font -->
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;700;800&display=swap" rel="stylesheet">

<style>
    #pata-benefits-widget {
        font-family: 'Outfit', sans-serif;
        width: 100%;
        overflow: hidden;
        padding: 40px 0 80px 0;
        background: transparent;
        position: relative;
    }

    .pata-section-title {
        text-align: left;
        font-size: 48px;
        line-height: 1.1;
        font-weight: 800;
        color: #FF0055;
        margin-bottom: 20px;
        padding-left: 20px;
        max-width: 90%;
        /* Más espacio en mobile */
    }

    @media (min-width: 768px) {
        .pata-section-title {
            font-size: 64px;
            padding-left: 5%;
            max-width: 800px;
            /* Suficiente espacio para que no se corte */
        }
    }

    @media (min-width: 1200px) {
        .pata-section-title {
            font-size: 80px;
            max-width: 1000px;
            /* Full width permitido */
        }
    }

    /* Container del slider - posición relativa para las cards absolutas */
    .stacked-slider-container {
        position: relative;
        width: 100%;
        height: 520px;
        /* Altura fija para el contenedor */
        display: flex;
        align-items: center;
        justify-content: center;
    }

    /* Cada card */
    .stacked-card {
        position: absolute;
        width: 280px;
        height: 420px;
        border-radius: 30px;
        overflow: hidden;
        background: #fff;
        user-select: none;
        cursor: pointer;

        /* Transiciones suaves */
        transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1),
            opacity 0.4s ease,
            box-shadow 0.4s ease;

        /* Estado por defecto (oculto) */
        opacity: 0;
        transform: scale(0.6) translateX(0);
        z-index: 0;
        pointer-events: none;
    }

    @media (min-width: 768px) {
        .stacked-card {
            width: 320px;
            height: 480px;
        }
    }

    /* ========== ESTADOS DE LAS CARDS ========== */

    /* ACTIVA (Centro) */
    .stacked-card.is-active {
        opacity: 1;
        transform: scale(1) translateX(0);
        z-index: 50;
        pointer-events: auto;
        box-shadow: 0 30px 60px rgba(0, 0, 0, 0.3);
    }

    /* PREV 1 (Izquierda inmediata - DETRÁS de activa) */
    .stacked-card.is-prev-1 {
        opacity: 1;
        transform: scale(0.88) translateX(-70%);
        z-index: 40;
        pointer-events: auto;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
    }

    /* NEXT 1 (Derecha inmediata - DETRÁS de activa) */
    .stacked-card.is-next-1 {
        opacity: 1;
        transform: scale(0.88) translateX(70%);
        z-index: 40;
        pointer-events: auto;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
    }

    /* PREV 2 (Izquierda lejana - DETRÁS de prev-1) */
    .stacked-card.is-prev-2 {
        opacity: 1;
        transform: scale(0.76) translateX(-120%);
        z-index: 30;
        pointer-events: auto;
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
    }

    /* NEXT 2 (Derecha lejana - DETRÁS de next-1) */
    .stacked-card.is-next-2 {
        opacity: 1;
        transform: scale(0.76) translateX(120%);
        z-index: 30;
        pointer-events: auto;
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
    }

    /* Mobile adjustments */
    @media (max-width: 768px) {
        .stacked-slider-container {
            height: 450px;
        }

        .stacked-card.is-prev-1 {
            transform: scale(0.85) translateX(-55%);
        }

        .stacked-card.is-next-1 {
            transform: scale(0.85) translateX(55%);
        }

        .stacked-card.is-prev-2 {
            transform: scale(0.7) translateX(-95%);
        }

        .stacked-card.is-next-2 {
            transform: scale(0.7) translateX(95%);
        }
    }

    /* Contenido de la Card */
    .pata-card-content {
        height: 100%;
        padding: 25px;
        display: flex;
        flex-direction: column;
        color: white;
        position: relative;
        z-index: 2;
    }

    .pata-card-icon {
        width: 55px;
        height: 55px;
        margin-bottom: 15px;
        background: rgba(255, 255, 255, 0.25);
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .pata-card-icon img {
        width: 60%;
        height: 60%;
        object-fit: contain;
        filter: brightness(0) invert(1);
    }

    .pata-card-title {
        font-size: 28px;
        font-weight: 800;
        line-height: 1.1;
        margin-bottom: 12px;
    }

    .pata-card-desc {
        font-size: 14px;
        line-height: 1.5;
        opacity: 0.95;
        max-width: 90%;
    }

    .pata-card-image {
        position: absolute;
        bottom: 0;
        right: 0;
        width: 100%;
        height: 50%;
        z-index: 1;
        display: flex;
        align-items: flex-end;
        justify-content: center;
    }

    .pata-card-image img {
        max-width: 90%;
        max-height: 100%;
        object-fit: contain;
        object-position: bottom center;
    }

    /* Colores */
    .bg-teal {
        background: linear-gradient(135deg, #00C2B8 0%, #00A8A0 100%);
    }

    .bg-orange {
        background: linear-gradient(135deg, #FF9100 0%, #FF7800 100%);
    }

    .bg-pink {
        background: linear-gradient(135deg, #FF0066 0%, #E60055 100%);
    }

    .bg-lime {
        background: linear-gradient(135deg, #9FD406 0%, #8BC205 100%);
    }

    .bg-yellow {
        background: linear-gradient(135deg, #FFC107 0%, #FFB300 100%);
    }

    /* Botones de Navegación */
    .slider-nav-btn {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        width: 48px;
        height: 48px;
        background: white;
        border: none;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #FF0055;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
        cursor: pointer;
        z-index: 100;
        transition: transform 0.2s, box-shadow 0.2s;
    }

    .slider-nav-btn:hover {
        transform: translateY(-50%) scale(1.1);
        box-shadow: 0 6px 25px rgba(0, 0, 0, 0.2);
    }

    .slider-nav-btn svg {
        width: 22px;
        height: 22px;
        stroke: currentColor;
        stroke-width: 3;
        fill: none;
    }

    /* Posicionamiento de flechas pegadas a la card central */
    .slider-nav-prev {
        left: 50%;
        margin-left: -190px;
    }

    .slider-nav-next {
        right: 50%;
        margin-right: -190px;
    }

    @media (min-width: 768px) {
        .slider-nav-prev {
            margin-left: -210px;
        }

        .slider-nav-next {
            margin-right: -210px;
        }
    }

    /* Paginación */
    .slider-pagination {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin-top: 30px;
    }

    .slider-dot {
        width: 10px;
        height: 10px;
        border-radius: 50%;
        background: #ddd;
        border: none;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .slider-dot.active {
        background: #FF0055;
        transform: scale(1.2);
    }
</style>

<div id="pata-benefits-widget">
    <h2 class="pata-section-title">lo que nuestra membresía ofrece</h2>

    <div class="stacked-slider-container" id="stackedSlider">

        <!-- Card 0: Apoyo (Teal) -->
        <div class="stacked-card bg-teal" data-index="0">
            <div class="pata-card-content">
                <div class="pata-card-icon">
                    <img src="https://cdn.prod.website-files.com/66fd58784013115456201a09/670438f21976c6c731f82e1c_ico-cross.svg"
                        alt="Icono">
                </div>
                <div class="pata-card-title">Apoyo momentos difíciles</div>
                <div class="pata-card-desc">Hasta $2,000 al año, te ayudamos a decir adiós con todo el amor.</div>
            </div>
            <div class="pata-card-image">
                <img src="https://cdn.prod.website-files.com/plugins/Basic/assets/placeholder.60f9b1840c.svg"
                    alt="Mascota">
            </div>
        </div>

        <!-- Card 1: Vacuna (Naranja) -->
        <div class="stacked-card bg-orange" data-index="1">
            <div class="pata-card-content">
                <div class="pata-card-icon">
                    <img src="https://cdn.prod.website-files.com/66fd58784013115456201a09/670438f21976c6c731f82e1c_ico-cross.svg"
                        alt="Icono">
                </div>
                <div class="pata-card-title">Vacuna anual</div>
                <div class="pata-card-desc">Hasta $300 al año, porque prevenir es amar. Te ayudamos a mantenerlo sano.
                </div>
            </div>
            <div class="pata-card-image">
                <img src="https://cdn.prod.website-files.com/plugins/Basic/assets/placeholder.60f9b1840c.svg"
                    alt="Mascota">
            </div>
        </div>

        <!-- Card 2: Emergencia (Rosa) - INICIAL ACTIVA -->
        <div class="stacked-card bg-pink" data-index="2">
            <div class="pata-card-content">
                <div class="pata-card-icon">
                    <img src="https://cdn.prod.website-files.com/66fd58784013115456201a09/670438f21976c6c731f82e1c_ico-cross.svg"
                        alt="Icono">
                </div>
                <div class="pata-card-title">Emergencia médica</div>
                <div class="pata-card-desc">Hasta $3,000 al año, juntos rescatamos más vidas, unidos por amor.</div>
            </div>
            <div class="pata-card-image">
                <img src="https://cdn.prod.website-files.com/6929d5e779839f5517dc2ded/693991ad1e9e5d0b490f9020_animated-dog-image-0929.png"
                    alt="Perro Golden">
            </div>
        </div>

        <!-- Card 3: Consultorio (Lima) -->
        <div class="stacked-card bg-lime" data-index="3">
            <div class="pata-card-content">
                <div class="pata-card-icon">
                    <img src="https://cdn.prod.website-files.com/66fd58784013115456201a09/670438f21976c6c731f82e1c_ico-cross.svg"
                        alt="Icono">
                </div>
                <div class="pata-card-title">Consultorio Veterinario</div>
                <div class="pata-card-desc">Tips y apoyo para cuidar con empatía y conocimiento.</div>
            </div>
            <div class="pata-card-image">
                <img src="https://cdn.prod.website-files.com/plugins/Basic/assets/placeholder.60f9b1840c.svg"
                    alt="Mascota">
            </div>
        </div>

        <!-- Card 4: Donaciones (Amarillo) -->
        <div class="stacked-card bg-yellow" data-index="4">
            <div class="pata-card-content">
                <div class="pata-card-icon">
                    <img src="https://cdn.prod.website-files.com/66fd58784013115456201a09/670438f21976c6c731f82e1c_ico-cross.svg"
                        alt="Icono">
                </div>
                <div class="pata-card-title">Donaciones a refugios</div>
                <div class="pata-card-desc">Destinamos parte del dinero a rescates que salvan vidas.</div>
            </div>
            <div class="pata-card-image">
                <img src="https://cdn.prod.website-files.com/plugins/Basic/assets/placeholder.60f9b1840c.svg"
                    alt="Mascota">
            </div>
        </div>

        <!-- Flechas de Navegación -->
        <button class="slider-nav-btn slider-nav-prev" id="prevBtn">
            <svg viewBox="0 0 24 24">
                <path d="M15 18l-6-6 6-6" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
        </button>
        <button class="slider-nav-btn slider-nav-next" id="nextBtn">
            <svg viewBox="0 0 24 24">
                <path d="M9 18l6-6-6-6" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
        </button>
    </div>

    <!-- Paginación -->
    <div class="slider-pagination" id="sliderPagination"></div>
</div>

<script>
    (function () {
        const cards = document.querySelectorAll('.stacked-card');
        const totalCards = cards.length;
        let activeIndex = 2; // Empezar en la card rosa (índice 2)

        // Crear dots de paginación
        const pagination = document.getElementById('sliderPagination');
        for (let i = 0; i < totalCards; i++) {
            const dot = document.createElement('button');
            dot.className = 'slider-dot';
            dot.dataset.index = i;
            dot.addEventListener('click', () => goToSlide(i));
            pagination.appendChild(dot);
        }

        // Función para calcular el índice circular
        function getCircularIndex(index) {
            return ((index % totalCards) + totalCards) % totalCards;
        }

        // Función principal para actualizar las posiciones
        function updateSlider() {
            cards.forEach((card, i) => {
                // Limpiar todas las clases de estado
                card.classList.remove('is-active', 'is-prev-1', 'is-prev-2', 'is-next-1', 'is-next-2');
            });

            // Asignar clases según posición relativa al activo
            const active = getCircularIndex(activeIndex);
            const prev1 = getCircularIndex(activeIndex - 1);
            const prev2 = getCircularIndex(activeIndex - 2);
            const next1 = getCircularIndex(activeIndex + 1);
            const next2 = getCircularIndex(activeIndex + 2);

            cards[active].classList.add('is-active');
            cards[prev1].classList.add('is-prev-1');
            cards[prev2].classList.add('is-prev-2');
            cards[next1].classList.add('is-next-1');
            cards[next2].classList.add('is-next-2');

            // Actualizar dots
            document.querySelectorAll('.slider-dot').forEach((dot, i) => {
                dot.classList.toggle('active', i === active);
            });
        }

        // Navegación
        function goToSlide(index) {
            activeIndex = index;
            updateSlider();
        }

        function nextSlide() {
            activeIndex = getCircularIndex(activeIndex + 1);
            updateSlider();
        }

        function prevSlide() {
            activeIndex = getCircularIndex(activeIndex - 1);
            updateSlider();
        }

        // Event Listeners
        document.getElementById('nextBtn').addEventListener('click', nextSlide);
        document.getElementById('prevBtn').addEventListener('click', prevSlide);

        // Swipe support para mobile
        let touchStartX = 0;
        let touchEndX = 0;
        const slider = document.getElementById('stackedSlider');

        slider.addEventListener('touchstart', (e) => {
            touchStartX = e.changedTouches[0].screenX;
        }, { passive: true });

        slider.addEventListener('touchend', (e) => {
            touchEndX = e.changedTouches[0].screenX;
            const diff = touchStartX - touchEndX;
            if (Math.abs(diff) > 50) {
                if (diff > 0) nextSlide();
                else prevSlide();
            }
        }, { passive: true });

        // Click en cards para navegar
        cards.forEach((card, i) => {
            card.addEventListener('click', () => {
                if (!card.classList.contains('is-active')) {
                    goToSlide(i);
                }
            });
        });

        // Inicializar
        updateSlider();
    })();
</script>